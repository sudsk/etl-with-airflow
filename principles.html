

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Principles &mdash; Data Engineering</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Search and Insights" href="search-analytics.html" />
    <link rel="prev" title="Data Engineering Handbook 0.1" href="index.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Data Engineering Handbook 0.1
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Principles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#db1-primary-keys">DB1-Primary Keys</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db2-access-via-dataproc">DB2-Access via DataProc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db4-batch-progress">DB4-Batch progress</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db5-batch-restartable-idempotent">DB5-Batch restartable &amp; idempotent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db6-batch-monitorable">DB6-Batch monitorable</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db7-batch-terminability">DB7-Batch terminability</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db8-common-data-lexicon">DB8-Common data lexicon</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db9-re-buildable">DB9-(Re)-buildable</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db10-business-logic">DB10-Business logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db11-set-vs-row">DB11-Set vs Row</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db12-think-performance">DB12-Think performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db13-unit-performance-testing">DB13-Unit performance testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db14-code-instrumentation">DB14-Code Instrumentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db15-db-black-box-syndrome">DB15-DB Black Box Syndrome</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db16-its-a-database-not-a-data-dump">DB16-It’s a Database, Not a Data Dump</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db17-benchmark-benchmark-benchmark">DB17-Benchmark, Benchmark, Benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="#db18-minimise-database-accesses">DB18-Minimise database accesses</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="search-analytics.html">Search and Insights</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-pipelines.html">Data Pipelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="reconciliation.html">Reconciliation</a></li>
</ul>

            
          
    <br/>
    <br/>
    <a href=""><img src="_images/GitHub-Mark-Light-32px.png">&nbsp;Go to Github</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Data Engineering Handbook 0.1</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Principles</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="principles">
<h1>Principles<a class="headerlink" href="#principles" title="Permalink to this headline">¶</a></h1>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">What you will find here are data engineering principles…</p>
</div>
<div class="section" id="db1-primary-keys">
<h2>DB1-Primary Keys<a class="headerlink" href="#db1-primary-keys" title="Permalink to this headline">¶</a></h2>
<p>Keys should be unique, meaningless and unchanging</p>
<p>These are considered to be good principles for keys as it helps you avoid issues around using common data items like email addresses as the basis of some sort of key or identifier.</p>
<p>Product codes are another common trap that are sometimes used as codes - which is fine until the product code changes</p>
</div>
<div class="section" id="db2-access-via-dataproc">
<h2>DB2-Access via DataProc<a class="headerlink" href="#db2-access-via-dataproc" title="Permalink to this headline">¶</a></h2>
<p>DB2 Access to databases should be via stored procedures, but logic should only be added to preserve integrity or another NFR property.</p>
<p>Direct table access should be avoided. Data extraction methods e.g. views, functions, stored procedures do provide an additional layer of security as the set of permitted operations on the database are constrained by removing direct table access permissions. This also provides an abstraction layer that can enable database structure changes to be abstracted out and thus isolate the change impact. Logic inside stored procedures is encouraged if it helps protect data integrity, security or performance and be a data logic. Information logic should be left for the application to handle.</p>
<p>DB3-Change control tools</p>
<p>We should make use of database change control tools to ease the maintenance and deployment of database changes</p>
<p>The code to create/modify database structures and/or content must be controlled with the same rigour and comparable tools as that for those used for software applications. This also facilitates consistent test results across environments.</p>
</div>
<div class="section" id="db4-batch-progress">
<h2>DB4-Batch progress<a class="headerlink" href="#db4-batch-progress" title="Permalink to this headline">¶</a></h2>
<p>Batch jobs should demonstrate linear progress with time by committing in modest batch sizes.</p>
<p>Batch jobs that are long running and either totally commit or totally roll-back are forbidden unless that behaviour is specifically required.</p>
<p>Bulk inserts into a database within a transactional scope tend to be more performant for a limited batch sizes within the range of 500-1000 rows. Extending the number of inserts beyond this size has two detrimental effects. Firstly the transaction rollback log file will grow very large and second progress becomes opaque. If you kill a job after 60 hours you lose all progress but yet the job might have fully completed after 5 more minutes.</p>
<p>AN ETL ‘job’ (control-m?) should be transparent and broken down into Steps &amp; Tasks (workflow).
Job → Steps → Tasks
The workflow should be defined, so that the Steps and Tasks are transparent and visible, and during execution it should be monitor-able to see progress made on Steps and Tasks.
Steps could be parallel or serial. [MDJ to reword]</p>
</div>
<div class="section" id="db5-batch-restartable-idempotent">
<h2>DB5-Batch restartable &amp; idempotent<a class="headerlink" href="#db5-batch-restartable-idempotent" title="Permalink to this headline">¶</a></h2>
<p>Batch jobs must be designed to be automatically restartable from the point where they left off and be idempotent.</p>
<p>Running the same batch job multiple times should only increase progress of the job until completion, it should not introduce any side-effects in terms of duplicated record creation. Running the same job on a data set already processed should have no side-effect</p>
<p>When you run ETL to load data from a source system into the DW, it is possible that you may need to restart the ETL load after a failure. After such a failure during ETL, to avoid restarting the entire ETL after a failure, which would require inefficient re-runs of all ETL tasks, you must restart the ETL from the same point in its execution once the cause of failure has been diagnosed and resolved.
Restartability Grain - When you restart an ETL after a failure, you may not restart again from the exact point of failure, depending on where it occurred and on dependencies between ETL steps. The point of restartability is that the end result of the ETL execution is the same regardless of any ETL failure.
To maintain data integrity in the case of restart, the grain would vary depending on the location in the hierarchy of the failed step and on the Restart setting for the step in the workflow definition. Basically meaning the restartability grain should be definable at a step level. [MDJ to reword]</p>
</div>
<div class="section" id="db6-batch-monitorable">
<h2>DB6-Batch monitorable<a class="headerlink" href="#db6-batch-monitorable" title="Permalink to this headline">¶</a></h2>
<p>The progress of all batch jobs including progress, completion and failure must be explicitly observable by operations teams</p>
<p>It is vital that operations teams can monitor the observable progress of all long running batch jobs and the final outcome of the job.
The workflow should support monitoring Steps/Tasks completed, running and pending. All jobs must adhere to incremental progress in reasonable measures.</p>
</div>
<div class="section" id="db7-batch-terminability">
<h2>DB7-Batch terminability<a class="headerlink" href="#db7-batch-terminability" title="Permalink to this headline">¶</a></h2>
<p>All batch jobs must be killable with no side-effect by the operations team, explicit automated kill commands must be provided as part of the batch job / script.</p>
<p>There can be no data or integrity loss as a result of killing a batch job by using the specified kill command</p>
</div>
<div class="section" id="db8-common-data-lexicon">
<h2>DB8-Common data lexicon<a class="headerlink" href="#db8-common-data-lexicon" title="Permalink to this headline">¶</a></h2>
<p>Seek a common data lexicon to build your domain model.</p>
<p>Mushrooming words for the same items are only recipes for confusion, management nightmares.</p>
</div>
<div class="section" id="db9-re-buildable">
<h2>DB9-(Re)-buildable<a class="headerlink" href="#db9-re-buildable" title="Permalink to this headline">¶</a></h2>
<p>Our databases should be (re)-buildable from an automated, version controlled source, both schema and data</p>
<p>We need reliable, repeatable process for this, so that we remove it as a potential bottleneck / problem on the speed of our delivery teams</p>
</div>
<div class="section" id="db10-business-logic">
<h2>DB10-Business logic<a class="headerlink" href="#db10-business-logic" title="Permalink to this headline">¶</a></h2>
<p>The database is not to be concerned by business logic.</p>
<p>The database job is about data. The business context that turns it into ‘information’ is the application concern. Focus on each strength. The activities of the database should be focussed on the handling and manipulation of data and stay away from external services.</p>
</div>
<div class="section" id="db11-set-vs-row">
<h2>DB11-Set vs Row<a class="headerlink" href="#db11-set-vs-row" title="Permalink to this headline">¶</a></h2>
<p>Always process at the set level, avoid processing individual rows.</p>
<p>In todays world, parsing large data volumes through cursors will prove impossibly challenging and beyond under performing. Bulk methods are available for all technologies.</p>
</div>
<div class="section" id="db12-think-performance">
<h2>DB12-Think performance<a class="headerlink" href="#db12-think-performance" title="Permalink to this headline">¶</a></h2>
<p>Think performance before writing first line of code.</p>
<p>Performance should be a Day-1 concern of writing code, not an afterthought, reactive and performance tuning activity
Think performance on Day-0. Think performance before data modelling. Think performance before writing first line of code.
Define Your Performance Goals from the Start.
Test Against Representative Data - Don’t wait till performance issues manifest in PPE and PROD.</p>
</div>
<div class="section" id="db13-unit-performance-testing">
<h2>DB13-Unit performance testing<a class="headerlink" href="#db13-unit-performance-testing" title="Permalink to this headline">¶</a></h2>
<p>As a part of unit testing, performance should be tested and recorded as well, wherever possible. Shouldn’t be left until the code reaches a performance test environment (e.g. Pre-Prod).</p>
</div>
<div class="section" id="db14-code-instrumentation">
<h2>DB14-Code Instrumentation<a class="headerlink" href="#db14-code-instrumentation" title="Permalink to this headline">¶</a></h2>
<p>The workflow should enable logs capture, which then makes analytics available for Steps and Tasks such as last 3 months min, max and avg timings. All jobs must have some ability to produce a log file output for monitoring purposes</p>
<p>Enable analytics for how the application has performed in the past e.g. last 3 months e.g. for Oracle Logging, DBMS_APPLICATION_INFO</p>
</div>
<div class="section" id="db15-db-black-box-syndrome">
<h2>DB15-DB Black Box Syndrome<a class="headerlink" href="#db15-db-black-box-syndrome" title="Permalink to this headline">¶</a></h2>
<p>Avoid the DB Black Box Syndrome - Database Independence versus Database Dependence.
Make use of database native features instead of reinventing it outside. Native features are built to give the best performance. An example could be all types of native data-transfer mechanism (TTS, DBlink, Data-Pump) vs. generic JDBC.</p>
</div>
<div class="section" id="db16-its-a-database-not-a-data-dump">
<h2>DB16-It’s a Database, Not a Data Dump<a class="headerlink" href="#db16-its-a-database-not-a-data-dump" title="Permalink to this headline">¶</a></h2>
<p>However structured or unstructured the data repository is, it is vital that the content integrity is respected. The data acquired must be (made) workable.</p>
</div>
<div class="section" id="db17-benchmark-benchmark-benchmark">
<h2>DB17-Benchmark, Benchmark, Benchmark<a class="headerlink" href="#db17-benchmark-benchmark-benchmark" title="Permalink to this headline">¶</a></h2>
<p>Benchmark everything - all approaches, alternatives, current vs past performance.</p>
</div>
<div class="section" id="db18-minimise-database-accesses">
<h2>DB18-Minimise database accesses<a class="headerlink" href="#db18-minimise-database-accesses" title="Permalink to this headline">¶</a></h2>
<p>Try to minimise the total number of database accesses made by the application; especially if working on the WPG.</p>
<p>Performance of Shopper Cells at HVEs is restricted by database access. Cache data if you can.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="search-analytics.html" class="btn btn-neutral float-right" title="Search and Insights" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Data Engineering Handbook 0.1" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright .

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>