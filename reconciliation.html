

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Reconciliation &mdash; Data Engineering</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Data Pipelines" href="data-pipelines.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Data Engineering Handbook 0.1
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
    
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="principles.html">Principles</a></li>
<li class="toctree-l1"><a class="reference internal" href="search-analytics.html">Search and Insights</a></li>
<li class="toctree-l1"><a class="reference internal" href="data-pipelines.html">Data Pipelines</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Reconciliation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#master-data-reconciliation">Master Data Reconciliation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reference-data-reconciliation">Reference Data Reconciliation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#transaction-data-reconciliation">Transaction Data Reconciliation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-transfer-metadata">Data transfer metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reconciliation-framework">Reconciliation Framework</a></li>
</ul>
</li>
</ul>

            
          
    <br/>
    <br/>
    <a href=""><img src="_images/GitHub-Mark-Light-32px.png">&nbsp;Go to Github</a>
  
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Data Engineering Handbook 0.1</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Reconciliation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="reconciliation">
<h1>Reconciliation<a class="headerlink" href="#reconciliation" title="Permalink to this headline">¶</a></h1>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">What you will find here are data reconciliation techniques and framework.</p>
</div>
<div class="section" id="master-data-reconciliation">
<h2>Master Data Reconciliation<a class="headerlink" href="#master-data-reconciliation" title="Permalink to this headline">¶</a></h2>
<p>Reconcile the number of merchants in full load.</p>
<ul class="simple">
<li>Total Number of NAP Merchants - Active, Closed, Suspended</li>
<li>Total Number of NAP Digital onboarded + non-onboarded - Active, Closed, Suspended</li>
<li>Total Number of PAP Merchants -  Active, Closed, Suspended</li>
<li>Total Number of PAP Digital onboarded + non-onboarded - Active, Closed, Suspended</li>
</ul>
</div>
<div class="section" id="reference-data-reconciliation">
<h2>Reference Data Reconciliation<a class="headerlink" href="#reference-data-reconciliation" title="Permalink to this headline">¶</a></h2>
<p>Reconcile Currency, MCC, Card Product Type, etc.</p>
</div>
<div class="section" id="transaction-data-reconciliation">
<h2>Transaction Data Reconciliation<a class="headerlink" href="#transaction-data-reconciliation" title="Permalink to this headline">¶</a></h2>
<p>Reconcile count, sum, etc. from staging till the target layer and capture all business failures, exclusions count.</p>
</div>
<div class="section" id="data-transfer-metadata">
<h2>Data transfer metadata<a class="headerlink" href="#data-transfer-metadata" title="Permalink to this headline">¶</a></h2>
<p><strong>Data transfer through tables</strong>
For data transfer through tables, use the below structure:</p>
<table border="1" class="colwidths-auto docutils" id="id1">
<caption><span class="caption-text">Table REC_OWNER.ETL_SOURCE_CONTROL</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">INTERFACE_NAME</th>
<th class="head">ETL_BATCH_ID</th>
<th class="head">ROWCOUNT</th>
<th class="head">CREATED_DATE</th>
<th class="head">CREATED_BY</th>
<th class="head">LAST_UPDATED_DATE</th>
<th class="head">LAST_UPDATED_BY</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>NAP-IF403-CQPR</td>
<td>10001</td>
<td>1996500</td>
<td>SYSDATE</td>
<td>ODI-&lt;session-id&gt;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>NAP-IF402-Merchant-Details</td>
<td>1021</td>
<td>8500</td>
<td>SYSDATE</td>
<td>ODI-&lt;session-id&gt;</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<p><strong>Data transfer through files</strong>
For data transfer through files, the source should ideally provide a compressed data file and a control file post-completion of the transfer process.
This process is called “Token aware” - Tokens are files created in the file system to trigger an ETL event. Applications that are token aware can poll a directory for the arrival of a token file.
The control file holds metadata information about the file transfers. The control file should have an “.info” extension.
There are variety of ways the data file and control file could be related - like one data file and one control file, multi data files and one control file, or multi data files and multi control files.</p>
<p>Take the example of simplest scenario - one compressed data file and one control file. The name of control file should be &lt;data file name&gt;.info.</p>
<p>The structure of control file is comma-delimited:
.. csv-table:: test.info</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">header:</th><td class="field-body">“FILE_NAME”,”FILE_COUNT”,”FILE_SIZE”,”CKSUM”,”CKSUM-METHOD”</td>
</tr>
<tr class="field-even field"><th class="field-name">widths:</th><td class="field-body">auto</td>
</tr>
</tbody>
</table>
<p>“test.gz”,”20000”,”43856377”,”d131dd02c5e6eec4”,”MD5”</p>
</div></blockquote>
<p>The above control file shows that “test.gz” contains 20,000 files, the file size of “test.gz” is 43856377 bytes and MD5 checksum is d131dd02c5e6eec4.</p>
<p>The data file names should be unique, both the compressed file and it’s content files should be unique. This is to prevent duplicates.</p>
<p>On the target side, the control-file should be loaded into the “REC_OWNER.ETL_SOURCE_CONTROL” table:
.. csv-table:: Table REC_OWNER.ETL_SOURCE_CONTROL</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">header:</th><td class="field-body">“INTERFACE_NAME”,”ETL_BATCH_ID”,”ROWCOUNT”,”CREATED_DATE”,”CREATED_BY”,”LAST_UPDATED_DATE”,”LAST_UPDATED_BY”</td>
</tr>
<tr class="field-even field"><th class="field-name">widths:</th><td class="field-body">auto</td>
</tr>
</tbody>
</table>
<p>“NAP-IF414-INVOICES”,”test.gz”,”20000”,”SYSDATE”,”ETL Process ID”,”“,”“</p>
</div></blockquote>
<p><strong>Streaming Data transfer - Topics/Queues/Streams</strong></p>
</div>
<div class="section" id="reconciliation-framework">
<h2>Reconciliation Framework<a class="headerlink" href="#reconciliation-framework" title="Permalink to this headline">¶</a></h2>
<p><strong>Reconciliation Table</strong></p>
<table border="1" class="colwidths-auto docutils" id="id2">
<caption><span class="caption-text">Table REC_OWNER.RECON_CONTROL</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">RECON_ID</th>
<th class="head">RECON_FROM</th>
<th class="head">RECON_TO</th>
<th class="head">SOURCE_ID</th>
<th class="head">TARGET_ID</th>
<th class="head">SOURCE_COUNT</th>
<th class="head">TARGET_COUNT</th>
<th class="head">CREATED_DATE</th>
<th class="head">CREATED_BY</th>
<th class="head">LAST_UPDATED_DATE</th>
<th class="head">LAST_UPDATED_BY</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1001</td>
<td>STG_CQPR</td>
<td>FINANCIAL_TRANS_EVENT</td>
<td>ETL_BATCH_ID/FILE_NAME</td>
<td>PROCESS_ID</td>
<td>1000</td>
<td>700</td>
<td>SYSDATE</td>
<td>PROCESS_ID</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
<table border="1" class="colwidths-auto docutils" id="id3">
<caption><span class="caption-text">Table REC_OWNER.RECON_CONTROL_DETAILS</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<thead valign="bottom">
<tr class="row-odd"><th class="head">RECON_ID</th>
<th class="head">RECON_TYPE</th>
<th class="head">CATEGORY</th>
<th class="head">KEY</th>
<th class="head">VALUE</th>
<th class="head">CREATED_DATE</th>
<th class="head">CREATED_BY</th>
<th class="head">LAST_UPDATED_DATE</th>
<th class="head">LAST_UPDATED_BY</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>1001</td>
<td>COUNT</td>
<td>EXCLUSION</td>
<td>REPRESENTMENT</td>
<td>54</td>
<td>SYSDATE</td>
<td>PROCESS_ID</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>1001</td>
<td>COUNT</td>
<td>EXCLUSION</td>
<td>NON-ONBOARDED</td>
<td>176</td>
<td>SYSDATE</td>
<td>PROCESS_ID</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>1001</td>
<td>COUNT</td>
<td>EXCLUSION</td>
<td>CORRECTS</td>
<td>32</td>
<td>SYSDATE</td>
<td>PROCESS_ID</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>1001</td>
<td>COUNT</td>
<td>BUSINESS-FAILURE</td>
<td>PAN-BLANK</td>
<td>54</td>
<td>SYSDATE</td>
<td>PROCESS_ID</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>1001</td>
<td>COUNT</td>
<td>BUSINESS-FAILURE</td>
<td>CURRENCY-BLANK</td>
<td>54</td>
<td>SYSDATE</td>
<td>PROCESS_ID</td>
<td>&#160;</td>
<td>&#160;</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="data-pipelines.html" class="btn btn-neutral" title="Data Pipelines" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright .

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>